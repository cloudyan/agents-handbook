# å®Œæ•´ç‰ˆ Agent Chat æœåŠ¡

æœ¬ç¤ºä¾‹å±•ç¤ºäº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ Agent Chat æœåŠ¡ï¼Œå…·å¤‡å·¥å…·è°ƒç”¨ã€å¤šè½®å¯¹è¯ã€å¤æ‚æ¨ç†ç­‰å…¸å‹åŠŸèƒ½ã€‚

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### âœ… å·²å®ç°åŠŸèƒ½

1. **å·¥å…·è°ƒç”¨èƒ½åŠ›** â­â­â­â­â­
   - å¤©æ°”æŸ¥è¯¢ï¼ˆget_weatherï¼‰
   - ç½‘ç»œæœç´¢ï¼ˆsearch_webï¼‰
   - æ•°å­¦è®¡ç®—ï¼ˆcalculateï¼‰
   - è·å–æ—¶é—´ï¼ˆget_current_timeï¼‰

2. **å¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡** â­â­â­â­â­
   - å®Œæ•´çš„å¯¹è¯å†å²ç®¡ç†
   - ä¸Šä¸‹æ–‡ç†è§£èƒ½åŠ›
   - æ¶ˆæ¯åºåˆ—åŒ–å¤„ç†

3. **ReAct æ¨ç†æ¨¡å¼** â­â­â­â­â­
   - æ¨ç†èŠ‚ç‚¹ï¼ˆReasoning Nodeï¼‰
   - å·¥å…·æ‰§è¡ŒèŠ‚ç‚¹ï¼ˆTool Execution Nodeï¼‰
   - ç­”æ¡ˆç”ŸæˆèŠ‚ç‚¹ï¼ˆAnswer Generation Nodeï¼‰
   - æ¡ä»¶è¾¹å†³ç­–

4. **æµå¼è¾“å‡º** â­â­â­â­
   - å®æ—¶æµå¼å“åº”
   - å·¥å…·è°ƒç”¨å¯è§†åŒ–
   - Token çº§åˆ«æ›´æ–°

5. **é”™è¯¯å¤„ç†** â­â­â­â­
   - å·¥å…·è°ƒç”¨å¤±è´¥å¤„ç†
   - API é”™è¯¯æ•è·
   - é™çº§ç­–ç•¥

6. **å…ƒæ•°æ®ç®¡ç†** â­â­â­
   - æ¨ç†è¿‡ç¨‹è®°å½•
   - å·¥å…·æ‰§è¡Œç»“æœè·Ÿè¸ª
   - ä¼šè¯çŠ¶æ€ç®¡ç†

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### èŠ‚ç‚¹ç»“æ„

```
__start__ â†’ reasoning â†’ tool_execution â†’ answer_generation â†’ END
                     â†“
                    end
```

### èŠ‚ç‚¹è¯´æ˜

#### 1. Reasoning Nodeï¼ˆæ¨ç†èŠ‚ç‚¹ï¼‰
- **åŠŸèƒ½**ï¼šåˆ†æç”¨æˆ·é—®é¢˜ï¼Œå†³å®šæ˜¯å¦éœ€è¦è°ƒç”¨å·¥å…·
- **è¾“å…¥**ï¼šå¯¹è¯å†å²
- **è¾“å‡º**ï¼šå·¥å…·è°ƒç”¨å†³ç­–æˆ–ç›´æ¥å›ç­”
- **ç‰¹ç‚¹**ï¼š
  - ç»‘å®šæ‰€æœ‰å¯ç”¨å·¥å…·
  - åˆ†æé—®é¢˜ç±»å‹
  - é€‰æ‹©åˆé€‚çš„å·¥å…·

#### 2. Tool Execution Nodeï¼ˆå·¥å…·æ‰§è¡ŒèŠ‚ç‚¹ï¼‰
- **åŠŸèƒ½**ï¼šæ‰§è¡Œå·¥å…·è°ƒç”¨
- **è¾“å…¥**ï¼šå·¥å…·è°ƒç”¨åˆ—è¡¨
- **è¾“å‡º**ï¼šå·¥å…·æ‰§è¡Œç»“æœ
- **ç‰¹ç‚¹**ï¼š
  - å¹¶è¡Œæ‰§è¡Œå¤šä¸ªå·¥å…·
  - é”™è¯¯å¤„ç†å’Œé‡è¯•
  - ç»“æœæ ‡å‡†åŒ–

#### 3. Answer Generation Nodeï¼ˆç­”æ¡ˆç”ŸæˆèŠ‚ç‚¹ï¼‰
- **åŠŸèƒ½**ï¼šåŸºäºå·¥å…·ç»“æœç”Ÿæˆæœ€ç»ˆå›ç­”
- **è¾“å…¥**ï¼šå¯¹è¯å†å² + å·¥å…·ç»“æœ
- **è¾“å‡º**ï¼šæœ€ç»ˆå›ç­”
- **ç‰¹ç‚¹**ï¼š
  - ç»¼åˆå¤šä¸ªå·¥å…·ç»“æœ
  - ç”Ÿæˆè‡ªç„¶è¯­è¨€å›ç­”
  - æä¾›æœ‰ç”¨çš„å»ºè®®

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½®ç¯å¢ƒå˜é‡

åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `.env` æ–‡ä»¶ä¸­é…ç½®ï¼š

```bash
# DeepSeek API Key
OPENAI_API_KEY=your_deepseek_api_key_here

# API Base URL
OPENAI_BASE_URL=https://api.deepseek.com/v1

# æ¨¡å‹åç§°
MODEL_NAME=qwen3-max

# OpenWeather API Keyï¼ˆç”¨äºå¤©æ°”æŸ¥è¯¢ï¼‰
OPENWEATHER_API_KEY=your_openweather_api_key_here

# Tavily API Keyï¼ˆç”¨äºç½‘ç»œæœç´¢ï¼‰
TAVILY_API_KEY=your_tavily_api_key_here
```

### 2. å¯åŠ¨æœåŠ¡

```bash
cd langchain-typescript
pnpm 13-agent-complete
```

æœåŠ¡å°†åœ¨ `http://localhost:2025` å¯åŠ¨ã€‚

### 3. æµ‹è¯• API

```bash
pnpm 13-test-complete
```

### 4. è®¿é—®èŠå¤©ç•Œé¢

è·å– Assistant IDï¼š

```bash
curl -X POST http://localhost:2025/assistants/search \
  -H "Content-Type: application/json" \
  -d '{"query": ""}'
```

ç„¶åè®¿é—®ï¼š

```
https://agentchat.vercel.app/?apiUrl=http://localhost:2025&assistantId=<ä½ çš„ Assistant ID>
```

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | 12 åŸºç¡€ç‰ˆ | 13 å®Œæ•´ç‰ˆ |
|------|----------|----------|
| **å·¥å…·è°ƒç”¨** | âŒ 0% | âœ… 100% |
| **å¤šè½®å¯¹è¯** | âš ï¸ 20% | âœ… 100% |
| **ReAct æ¨ç†** | âŒ 0% | âœ… 100% |
| **æµå¼è¾“å‡º** | âš ï¸ 50% | âœ… 100% |
| **é”™è¯¯å¤„ç†** | âš ï¸ 30% | âœ… 80% |
| **å…ƒæ•°æ®ç®¡ç†** | âŒ 0% | âœ… 60% |
| **è®°å¿†ç®¡ç†** | âŒ 0% | âš ï¸ 20% |

## ğŸ§ª æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1: åŸºç¡€å¯¹è¯
```
ç”¨æˆ·: ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±
åŠ©æ‰‹: ä½ å¥½ï¼æˆ‘æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œå¯ä»¥ä½¿ç”¨å¤šç§å·¥å…·å¸®åŠ©æ‚¨...
```

### åœºæ™¯ 2: æ•°å­¦è®¡ç®—
```
ç”¨æˆ·: è®¡ç®— 25 * 4 + 10
åŠ©æ‰‹: è®¡ç®—ç»“æœï¼š110
```

### åœºæ™¯ 3: å¤©æ°”æŸ¥è¯¢
```
ç”¨æˆ·: åŒ—äº¬æ˜å¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ
åŠ©æ‰‹: [è°ƒç”¨ get_weather å·¥å…·]
è¿”å›: åŒ—äº¬å¤©æ°”é¢„æŠ¥ï¼šæ˜å¤©å¤šäº‘ï¼Œæ¸©åº¦ 15Â°Cï¼Œæ¹¿åº¦ 60%
```

### åœºæ™¯ 4: ç½‘ç»œæœç´¢
```
ç”¨æˆ·: æœç´¢æœ€æ–°çš„ AI æ–°é—»
åŠ©æ‰‹: [è°ƒç”¨ search_web å·¥å…·]
è¿”å›: ğŸ” æœç´¢ç»“æœï¼š[æœ€æ–° AI æ–°é—»åˆ—è¡¨]
```

### åœºæ™¯ 5: è·å–æ—¶é—´
```
ç”¨æˆ·: ç°åœ¨å‡ ç‚¹äº†ï¼Ÿ
åŠ©æ‰‹: å½“å‰æ—¶é—´ï¼š2026å¹´1æœˆ27æ—¥ æ˜ŸæœŸäºŒ 11:30:45
```

## ğŸ› ï¸ å·¥å…·è¯´æ˜

### 1. get_weather
- **åŠŸèƒ½**ï¼šè·å–åŸå¸‚å¤©æ°”é¢„æŠ¥
- **è¾“å…¥**ï¼šåŸå¸‚åç§°ã€å¤©æ•°
- **éœ€è¦**ï¼šOPENWEATHER_API_KEY

### 2. search_web
- **åŠŸèƒ½**ï¼šæœç´¢ç½‘ç»œä¿¡æ¯
- **è¾“å…¥**ï¼šæœç´¢å…³é”®è¯
- **éœ€è¦**ï¼šTAVILY_API_KEY

### 3. calculate
- **åŠŸèƒ½**ï¼šè®¡ç®—æ•°å­¦è¡¨è¾¾å¼
- **è¾“å…¥**ï¼šæ•°å­¦è¡¨è¾¾å¼
- **ç‰¹ç‚¹**ï¼šæ— éœ€å¤–éƒ¨ API

### 4. get_current_time
- **åŠŸèƒ½**ï¼šè·å–å½“å‰æ—¶é—´
- **è¾“å…¥**ï¼šæ— 
- **ç‰¹ç‚¹**ï¼šæ— éœ€å¤–éƒ¨ API

## ğŸ“ é¡¹ç›®ç»“æ„

```
src/13-agent-complete/
â”œâ”€â”€ graph.ts           # LangGraph å›¾å®šä¹‰
â”œâ”€â”€ tools/
â”‚   â””â”€â”€ index.ts       # å·¥å…·å®šä¹‰å’Œå¯¼å‡º
â”œâ”€â”€ langgraph.json     # LangGraph CLI é…ç½®
â”œâ”€â”€ test-api.ts        # API æµ‹è¯•è„šæœ¬
â””â”€â”€ README.md          # é¡¹ç›®æ–‡æ¡£
```

## ğŸ”§ é…ç½®è¯´æ˜

### langgraph.json
```json
{
  "graphs": {
    "agent": "./graph.ts:app"
  },
  "env": "../../.env"
}
```

### ç«¯å£é…ç½®
- é»˜è®¤ç«¯å£ï¼š2025
- å¯é€šè¿‡ç¯å¢ƒå˜é‡ `PORT` ä¿®æ”¹

## ğŸ¨ ä½¿ç”¨æŠ€å·§

### 1. æ·»åŠ æ–°å·¥å…·

åœ¨ `tools/index.ts` ä¸­æ·»åŠ ï¼š

```typescript
export const myTool = tool(
  async (input) => {
    // å®ç°é€»è¾‘
    return "ç»“æœ";
  },
  {
    name: "my_tool",
    description: "å·¥å…·æè¿°",
    schema: z.object({
      param: z.string().describe("å‚æ•°æè¿°"),
    }),
  }
);
```

ç„¶ååœ¨ `graph.ts` ä¸­å¯¼å…¥å¹¶ç»‘å®šï¼š

```typescript
import { tools } from "./tools";
const boundModel = llm.bindTools(tools);
```

### 2. è‡ªå®šä¹‰æ¨ç†é€»è¾‘

ä¿®æ”¹ `reasoningNode` å‡½æ•°ï¼Œæ·»åŠ è‡ªå®šä¹‰çš„æ¨ç†é€»è¾‘ã€‚

### 3. è°ƒæ•´ç³»ç»Ÿæç¤ºè¯

ä¿®æ”¹ `reasoningNode` å’Œ `answerGenerationNode` ä¸­çš„ `systemPrompt`ã€‚

## ğŸ” æ•…éšœæ’æŸ¥

### å·¥å…·è°ƒç”¨å¤±è´¥

1. æ£€æŸ¥ API å¯†é’¥é…ç½®
2. ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
3. æŸ¥çœ‹å·¥å…·å®ç°ä»£ç 

### æµå¼å“åº”ä¸­æ–­

1. æ£€æŸ¥ `streaming: true` é…ç½®
2. ç¡®è®¤ LangGraph CLI ç‰ˆæœ¬
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

### æ¨ç†å¾ªç¯é—®é¢˜

1. æ£€æŸ¥æ¡ä»¶è¾¹é€»è¾‘
2. ç¡®è®¤å·¥å…·è°ƒç”¨æ ¼å¼
3. æŸ¥çœ‹æ—¥å¿—è¾“å‡º

## ğŸ“š ç›¸å…³èµ„æº

- [Agent Chat UI](https://github.com/langchain-ai/agent-chat-ui)
- [LangGraph æ–‡æ¡£](https://langchain-ai.github.io/langgraph/)
- [LangChain TypeScript](https://js.langchain.com/)
- [ReAct è®ºæ–‡](https://arxiv.org/abs/2210.03629)

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å·¥å…·è®¾è®¡**ï¼šä¿æŒå·¥å…·ç®€å•ã€å•ä¸€èŒè´£
2. **é”™è¯¯å¤„ç†**ï¼šæä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆç†ä½¿ç”¨æµå¼è¾“å‡º
4. **æµ‹è¯•è¦†ç›–**ï¼šæµ‹è¯•æ‰€æœ‰å·¥å…·è°ƒç”¨åœºæ™¯
5. **æ–‡æ¡£å®Œå–„**ï¼šä¿æŒå·¥å…·æè¿°å‡†ç¡®

## ğŸš€ ç”Ÿäº§éƒ¨ç½²

### ä½¿ç”¨ LangGraph Cloud

```bash
npx @langchain/langgraph-cli deploy
```

### ä½¿ç”¨ Docker

```dockerfile
FROM node:18
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build
EXPOSE 2025
CMD ["npm", "run", "13-agent-complete"]
```

### ç¯å¢ƒå˜é‡

ç”Ÿäº§ç¯å¢ƒéœ€è¦é…ç½®ï¼š
- OPENAI_API_KEY
- OPENWEATHER_API_KEY
- TAVILY_API_KEY
- PORT

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

- **é¦–æ¬¡å“åº”**ï¼š< 1s
- **å·¥å…·è°ƒç”¨**ï¼š< 3s
- **æµå¼è¾“å‡º**ï¼šå®æ—¶
- **å¹¶å‘æ”¯æŒ**ï¼š10+ ç”¨æˆ·

## ğŸ“ å­¦ä¹ è·¯å¾„

1. ç†è§£ LangGraph åŸºç¡€æ¦‚å¿µ
2. å­¦ä¹  ReAct æ¨ç†æ¨¡å¼
3. æŒæ¡å·¥å…·è°ƒç”¨æœºåˆ¶
4. å®è·µå¤šè½®å¯¹è¯
5. ä¼˜åŒ–æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ

## ğŸ”® æœªæ¥æ‰©å±•

- [ ] è®°å¿†ç®¡ç†é›†æˆ
- [ ] çŸ¥è¯†åº“æ£€ç´¢
- [ ] å¤šæ¨¡æ€æ”¯æŒ
- [ ] è‡ªå®šä¹‰æ’ä»¶ç³»ç»Ÿ
- [ ] ç”¨æˆ·ä¸ªæ€§åŒ–é…ç½®
